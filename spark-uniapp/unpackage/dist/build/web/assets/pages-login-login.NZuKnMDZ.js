import{v as e,r as a,b as s,w as l,d as t,o,e as n,f as i,t as r,s as c,x as d,y as u,z as p,A as m,B as f,C as _,m as g,I as h,n as w}from"./index-DiFUrjbL.js";import{_ as k,h as v}from"./_plugin-vue_export-helper.BWtSqQHM.js";const y=k({__name:"login",setup(k){const y=e({email:"",password:""}),b=a(!1),x=async()=>{var e;if(y.email.trim())if(e=y.email,/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e))if(y.password.trim())if(y.password.length<6)c({title:"密码长度至少6位",icon:"none"});else{b.value=!0,d({title:"登录中..."});try{const e=await v.login({email:y.email.trim(),password:y.password});u.setToken(e.token),u.setUserInfo(e.user),c({title:"登录成功",icon:"success"}),setTimeout((()=>{p({url:"/pages/workspace/workspace"})}),1500)}catch(a){console.error("登录失败:",a);let e=a.message||"登录失败，请检查邮箱和密码";e.includes("超时")||e.includes("连接")?m({title:"连接失败",content:e+"\n\n请检查：\n1. 后端服务是否已启动（运行 python spark-backend/main.py）\n2. 访问 http://localhost:8000/health 测试后端是否正常\n3. 检查后端日志是否有错误信息",showCancel:!1,confirmText:"我知道了"}):c({title:e,icon:"none",duration:3e3})}finally{b.value=!1,f()}}else c({title:"请输入密码",icon:"none"});else c({title:"请输入正确的邮箱格式",icon:"none"});else c({title:"请输入邮箱",icon:"none"})},V=()=>{_({url:"/pages/register/register"})};return(e,a)=>{const c=g,d=t,u=h,p=w;return o(),s(d,{class:"login-page"},{default:l((()=>[n(d,{class:"header"},{default:l((()=>[n(c,{class:"title"},{default:l((()=>[i("欢迎使用 SparkCanvas")])),_:1}),n(c,{class:"subtitle"},{default:l((()=>[i("AI内容创作平台")])),_:1})])),_:1}),n(d,{class:"login-card card"},{default:l((()=>[n(d,{class:"input-group"},{default:l((()=>[n(c,{class:"label"},{default:l((()=>[i("邮箱")])),_:1}),n(u,{modelValue:y.email,"onUpdate:modelValue":a[0]||(a[0]=e=>y.email=e),class:"input",placeholder:"请输入邮箱","placeholder-class":"placeholder",type:"text"},null,8,["modelValue"])])),_:1}),n(d,{class:"input-group"},{default:l((()=>[n(c,{class:"label"},{default:l((()=>[i("密码")])),_:1}),n(u,{modelValue:y.password,"onUpdate:modelValue":a[1]||(a[1]=e=>y.password=e),class:"input",placeholder:"请输入密码","placeholder-class":"placeholder",type:"password"},null,8,["modelValue"])])),_:1}),n(p,{class:"btn login-btn",onClick:x,loading:b.value},{default:l((()=>[i(r(b.value?"登录中...":"登录"),1)])),_:1},8,["loading"]),n(d,{class:"footer-links"},{default:l((()=>[n(c,{class:"link",onClick:V},{default:l((()=>[i("还没有账号？立即注册")])),_:1})])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-6d466528"]]);export{y as default};
